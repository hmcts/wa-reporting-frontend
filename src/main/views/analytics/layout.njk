{% extends "layouts/main.njk" %}
{% from "govuk/components/header/macro.njk" import govukHeader %}
{% from "govuk/components/service-navigation/macro.njk" import govukServiceNavigation %}

{% block pageTitle %}Analytics{% endblock %}

{% block header %}
  {% set freshnessNavigationText = "Last refreshed: unavailable." %}
  {% if freshnessInsetText %}
    {% set freshnessNavigationText = freshnessInsetText
      | replace("Data last refreshed: ", "Last refreshed: ")
      | replace("Data freshness unavailable.", "Last refreshed: unavailable.") %}
  {% endif %}
  {% set navigationEndHtml %}
    <li class="govuk-service-navigation__item analytics-service-navigation__item--freshness">
      <span class="analytics-service-navigation__freshness-text">{{ freshnessNavigationText }}</span>
    </li>
    <li class="govuk-service-navigation__item analytics-service-navigation__item--signout">
      <a class="govuk-service-navigation__link" href="/logout">Sign out</a>
    </li>
  {% endset %}
  {{ govukHeader() }}
  {{ govukServiceNavigation({
    serviceName: "Task Management Report",
    serviceUrl: "/",
    navigation: [
      {
        text: "Overview",
        href: "/",
        current: pagePath == "/"
      },
      {
        text: "Tasks outstanding",
        href: "/outstanding",
        current: pagePath == "/outstanding"
      },
      {
        text: "Tasks completed",
        href: "/completed",
        current: pagePath == "/completed"
      },
      {
        text: "User overview",
        href: "/users",
        current: pagePath  == "/users"
      }
    ],
    slots: {
      navigationEnd: navigationEndHtml | trim
    }
  }) }}
{% endblock %}

{% block content %}
  {% block analyticsContent %}{% endblock %}
{% endblock %}

{% block pageScripts %}
  {{ super() }}
  {% include "webpack/analytics-js.njk" %}
{% endblock %}
